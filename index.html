<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ріарѕ░рЇІ рІ▓рїѓрЅ│рѕЇ рЅбріЋрїј - Player</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Ethiopic:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Triple Border Effect -->
        <div class="border-container">
            <div class="border green"></div>
            <div class="border yellow"></div>
            <div class="border red"></div>
            
            <div class="main-content">
                <!-- Room Join Section -->
                <div id="joinSection" class="section active">
                    <h1 class="amharic-text">­Ъј« ріарѕ░рЇІ рІ▓рїѓрЅ│рѕЇ рЅбріЋрїј</h1>
                    <div class="form-group">
                        <label class="amharic-text">рѕхрѕЮ</label>
                        <input type="text" id="playerName" placeholder="рѕЎрѕЅ рѕхрѕЮ" class="form-control">
                    </div>
                    <div class="form-group">
                        <label class="amharic-text">рІерїерІІрЅ│ рЅцрЅх рЅЂрїЦрѕГ</label>
                        <input type="text" id="roomCode" placeholder="1234" class="form-control">
                    </div>
                    <div class="form-group">
                        <label class="amharic-text">рІерѕџрЅ│рІѕрЅЁ рЅЂрїЦрѕГ</label>
                        <input type="text" id="inviteCode" placeholder="123456" class="form-control">
                    </div>
                    <button id="joinBtn" class="btn btn-success amharic-text">рЅ░рЅђрѕІрЅђрѕЇ</button>
                    
                    <div class="info-box">
                        <p class="amharic-text">­ЪЊ▒ рЅарїерІІрЅ│рІЇ рѕѕрѕўрѕ│рЅ░рЇЇ:</p>
                        <ol class="amharic-text">
                            <li>рѕхрѕЮрІјріЋ рІФрѕхрїѕрЅА</li>
                            <li>рІерїерІІрЅ│ рЅцрЅх рЅЂрїЦрѕГ рІФрѕхрїѕрЅА (4 ріарѕЃрІЮ)</li>
                            <li>рІерѕџрЅ│рІѕрЅЁ рЅЂрїЦрѕГ рІФрѕхрїѕрЅА (6 ріарѕЃрІЮ)</li>
                            <li>"рЅ░рЅђрѕІрЅђрѕЇ" рІГрїФріЉ</li>
                        </ol>
                    </div>
                </div>

                <!-- Game Lobby -->
                <div id="lobbySection" class="section">
                    <h2 class="amharic-text" id="roomTitle">рїерІІрЅ│ рЅцрЅх: <span id="roomDisplay"></span></h2>
                    <div class="players-list" id="playersList">
                        <div class="amharic-text">рЅ░рїФрІІрЅЙрЅй ріЦрІерѕўрїА ріљрІЇ...</div>
                    </div>
                    <div class="status-box">
                        <p class="amharic-text" id="gameStatus">рїерІІрЅ│ ріЦрІерЅ░рїђрѕўрѕе ріљрІЇ...</p>
                        <div id="adminControls" class="hidden">
                            <button id="startGameBtn" class="btn btn-warning amharic-text">рїерІІрЅ│ рїђрѕЮрѕГ</button>
                            <button id="endGameBtn" class="btn btn-danger amharic-text">рїерІІрЅ│ ріарЅЂрѕЮ</button>
                        </div>
                    </div>
                </div>

                <!-- Game Board -->
                <div id="gameSection" class="section">
                    <div class="game-header">
                        <h2 class="amharic-text" id="gameRoomTitle"></h2>
                        <div class="player-count amharic-text">рЅ░рїФрІІрЅЙрЅй: <span id="playerCount">0</span></div>
                    </div>
                    
                    <div class="game-board">
                        <div id="bingoBoard">
                            <!-- Board will be generated here -->
                        </div>
                    </div>
                    
                    <div class="game-controls">
                        <div class="called-numbers">
                            <h3 class="amharic-text">рЅ░рїарѕГрЅ░рІЇ рІФрѕЅ рЅЂрїЦрѕ«рЅй</h3>
                            <div id="calledNumbers" class="numbers-display"></div>
                        </div>
                        
                        <div class="current-number">
                            <div class="number-circle" id="currentNumber">
                                <span>--</span>
                            </div>
                            <div class="number-label amharic-text">ріарѕЂріЋ рІерЅ░рїарѕФ</div>
                        </div>
                        
                        <button id="bingoBtn" class="btn btn-bingo amharic-text">рЅбріЋрїј! ­ЪјЅ</button>
                    </div>
                    
                    <div class="chat-section">
                        <div id="chatMessages" class="chat-messages"></div>
                        <div class="chat-input">
                            <input type="text" id="chatInput" placeholder="рѕўрѕЇрІЋріГрЅх рІГрї╗рЇЅ..." class="amharic-text">
                            <button id="sendChatBtn" class="btn btn-info">Ръц</button>
                        </div>
                    </div>
                </div>

                <!-- Winner Announcement -->
                <div id="winnerSection" class="section hidden">
                    <div class="winner-box">
                        <div class="confetti">­ЪјЅ</div>
                        <h2 class="amharic-text">рЅбріЋрїј!</h2>
                        <div class="winner-name amharic-text" id="winnerName"></div>
                        <div class="win-pattern amharic-text" id="winPattern"></div>
                        <div class="win-time amharic-text" id="winTime"></div>
                        <button id="continueBtn" class="btn btn-success amharic-text">рЅђрїЦрѕЇ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="callSound" src="https://assets.mixkit.co/sfx/preview/mixkit-bell-notification-933.mp3" preload="auto"></audio>
    <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" preload="auto"></audio>
    <audio id="joinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-game-ball-tap-2073.mp3" preload="auto"></audio>

    <script src="config.js"></script>
    <script src="ws.js"></script>
    <script src="rtc.js"></script>
    <script src="game.js"></script>
    <script>
        // Check if admin
        const urlParams = new URLSearchParams(window.location.search);
        const isAdmin = urlParams.get('admin') === 'true';
        
        if (isAdmin) {
            document.getElementById('adminControls').classList.remove('hidden');
        }
        
        // Initialize player name from localStorage
        const savedName = localStorage.getItem('bingoPlayerName');
        if (savedName) {
            document.getElementById('playerName').value = savedName;
        }
        
        // Join button handler
        document.getElementById('joinBtn').addEventListener('click', () => {
            const playerName = document.getElementById('playerName').value;
            const roomCode = document.getElementById('roomCode').value;
            const inviteCode = document.getElementById('inviteCode').value;
            
            if (!playerName || !roomCode || !inviteCode) {
                alert('ріЦрЅБріГрІј рѕЂрѕЅріЋрѕЮ рѕўрѕерїЃрІјрЅй рІФрѕхрїѕрЅА');
                return;
            }
            
            // Save name to localStorage
            localStorage.setItem('bingoPlayerName', playerName);
            
            // Connect to WebSocket
            connectToServer(playerName, roomCode, inviteCode);
        });
        
        // Start game button (admin only)
        document.getElementById('startGameBtn')?.addEventListener('click', () => {
            startGame();
        });
        
        // End game button (admin only)
        document.getElementById('endGameBtn')?.addEventListener('click', () => {
            endGame();
        });
        
        // Bingo button
        document.getElementById('bingoBtn').addEventListener('click', () => {
            declareBingo();
        });
        
        // Send chat message
        document.getElementById('sendChatBtn').addEventListener('click', sendChatMessage);
        document.getElementById('chatInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendChatMessage();
        });
        
        // Continue button after win
        document.getElementById('continueBtn').addEventListener('click', () => {
            document.getElementById('winnerSection').classList.add('hidden');
            document.getElementById('gameSection').classList.remove('hidden');
        });
        
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
        }
    </script>
</body>
</html>